(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mine/personal"],{"13c3":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var a={uniIcons:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(n.bind(null,"beec"))},uniEasyinput:function(){return n.e("uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput").then(n.bind(null,"8708"))},uniDatetimePicker:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-datetime-picker/components/uni-datetime-picker/uni-datetime-picker")]).then(n.bind(null,"f0fc"))}},s=function(){var e=this.$createElement,t=(this._self._c,0!=this.parameters.school_id?this.theschoolName.length:null),n=0==this.parameters.school_id||t<9?null:this.theschoolName.substring(0,9);this.$mp.data=Object.assign({},{$root:{g0:t,g1:n}})},o=[]},"1c41":function(e,t,n){"use strict";n.r(t);var a=n("ab0a"),s=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=s.a},"4b70":function(e,t,n){},"8d5e":function(e,t,n){"use strict";(function(e,t){var a=n("4ea4");n("f290");a(n("66fd"));var s=a(n("e8c5"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(s.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},ab0a:function(e,t,n){"use strict";(function(e){var a=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(n("2eee")),o=a(n("c973")),i={data:function(){return{parameters:{name:"",phone:null,sex:"",school_id:0,school_ids:"",grad_date:"",check_code:"",intro:"",nick_name:"",avatar_url:"",birthday:"",specialty:"",pic:""},theUser:{avatar_url:""},theLevel:0,theschoolName:"",sexs:["男","女"],theSexIndex:0}},onLoad:function(e){if(this.theLevel=e.level,this.theUser=this.$store.state.theLogonUser,this.$store.commit("changeTempImageUrl",{}),this.parameters.nick_name=this.theUser.nick_name,1==this.theLevel){var t=this.$store.state.theLogonUser;this.parameters.name=""==t.name||null==t.name?"":t.name,this.parameters.phone=""==t.phone||null==t.phone?"":t.phone;var n=""==t.sex||null==t.sex?"":t.sex;""!=n&&(this.theSexIndex=this.sexs.indexOf(n)),this.parameters.sex=this.sexs[this.theSexIndex],this.parameters.school_id=t.school_id,this.theschoolName=""==t.school_name||null==t.school_name?"":t.school_name,this.parameters.grad_date=""==t.grad_date||null==t.grad_date?"":t.grad_date}},onShow:function(){0!=this.$store.state.tempImageUrl.length&&(this.parameters.avatar_url=this.$store.state.tempImageUrl[0].url,this.toLogonRegister()),""!=this.$store.state.theNickName&&this.$store.state.theNickName!=this.theUser.nick_name&&(this.parameters.avatar_url=this.theUser.avatar_url,this.parameters.nick_name=this.$store.state.theNickName,this.toLogonRegister())},computed:{storePhone:function(){return this.$store.state.theLogonUser.phone},storeCodeSecond:function(){return this.$store.state.codeSecond}},methods:{selectedSexOne:function(e){this.theSexIndex=e,this.parameters.sex=this.sexs[e]},dateMaskClick:function(e){this.parameters.grad_date=e},sendCode:function(){var t=this;return new Promise((function(n,a){var i=t;i.isLoading="loading",""!=i.parameters.phone&&null!=i.parameters.phone&&11==i.parameters.phone.length?e.request({url:i.$store.state.theUrl+"/wechat/wx/sendSmsCheckCode",method:"POST",header:{token:i.$store.state.theToken},data:{phone:i.parameters.phone,type:1},success:function(t){var a=i;if(0==t.data.code){var r=59,h=setInterval((function(){r-=1,a.$store.commit("changecodeSecond",{codeSecond:r}),0==r&&clearInterval(h)}),1e3);e.showToast({title:"验证码已发送，请及时查收！",duration:2500,icon:"none"}),n()}else if(500==t.data.code)e.showToast({title:"服务器连接失败，请反馈官方客服哦~",duration:2500,icon:"none"});else if(410==t.data.code){var c=a;(0,o.default)(s.default.mark((function e(){return s.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c.$store.dispatch("toLogon",{});case 2:c.theUser=c.$store.state.theLogonUser,c.sendCode();case 4:case"end":return e.stop()}}),e)})))()}else e.showToast({title:t.data.msg,duration:2500,icon:"none"})},fail:function(t){e.showToast({title:"网络失败，请重试！多次无效后，反馈官方客服哦！",duration:2500,icon:"none"})}}):e.showToast({title:"请填写正确的手机号码！",duration:2500,icon:"none"})}))},toLogonRegister:function(){var t=this;return new Promise((function(n,a){var i=t;i.inspect()&&e.request({url:i.$store.state.theUrl+"/wechat/wx/logon",method:"POST",header:{token:i.$store.state.theToken},data:i.parameters,success:function(t){var a=i;if(0==t.data.code)a.$store.commit("changeTheLogonUser_register",{level:t.data.data.user.level,theToken:t.data.data.token,avatar_url:t.data.data.user.avatar_url,nick_name:t.data.data.user.nick_name}),n();else if(500==t.data.code)e.showToast({title:"服务器连接失败，请反馈官方客服哦~",duration:2500,icon:"none"});else if(410==t.data.code){var r=a;(0,o.default)(s.default.mark((function e(){return s.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.$store.dispatch("toLogon",{});case 2:r.theUser=r.$store.state.theLogonUser,r.toLogonRegister();case 4:case"end":return e.stop()}}),e)})))()}else e.showToast({title:t.data.msg,duration:2500,icon:"none"})},fail:function(t){e.showToast({title:"网络失败，请重试！多次无效后，反馈官方客服哦！",duration:2500,icon:"none"})}})}))},inspect:function(){return this.parameters.school_ids=""==this.theUser.school_ids||null==this.theUser.school_ids?"":this.theUser.school_ids,this.parameters.intro=""==this.theUser.intro||null==this.theUser.intro?"":this.theUser.intro,this.parameters.birthday=""==this.theUser.birthday||null==this.theUser.birthday?"":this.theUser.birthday,this.parameters.specialty=""==this.theUser.specialty||null==this.theUser.specialty?"":this.theUser.specialty,this.parameters.nick_name.length>7||this.parameters.nick_name.length<1?(e.showToast({title:"昵称至少1个字符，最多不超过7个字符哦~",duration:2500,icon:"none"}),!1):""==this.parameters.phone||11!=this.parameters.phone.length?(e.showToast({title:"请正确填写手机号码哦~",duration:2500,icon:"none"}),!1):this.parameters.phone==this.theUser.phone||""==this.parameters.phone||""!=this.parameters.check_code||(e.showToast({title:"请获取并正确输入验证码~",duration:2500,icon:"none"}),!1)},toAddress:function(){0==this.theLevel?e.navigateTo({url:"/pages/index/address?type=register"}):e.showToast({title:"提交后不可修改哦~",duration:2500,icon:"none"})},toEditAvatar:function(){e.navigateTo({url:"/pages/mine/edit_avatar"})},toEditOther:function(t,n){e.navigateTo({url:"/pages/mine/edit_other?=type="+t+"&value="+n})}}};t.default=i}).call(this,n("543d")["default"])},e8c5:function(e,t,n){"use strict";n.r(t);var a=n("13c3"),s=n("1c41");for(var o in s)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return s[e]}))}(o);n("f14d");var i=n("f0c5"),r=Object(i["a"])(s["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);t["default"]=r.exports},f14d:function(e,t,n){"use strict";var a=n("4b70"),s=n.n(a);s.a}},[["8d5e","common/runtime","common/vendor"]]]);