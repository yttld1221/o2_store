(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{4042:function(t,e,s){"use strict";(function(t){var o=s("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(s("2eee")),i=o(s("c973")),a={data:function(){return{contentText:{contentdown:"查看更多",contentrefresh:"加载中...",contentnomore:"到底了，可点击此处手动加载~"},isLoading:"loading",theGetMomentsListPage:1,theGetMomentsListPagesize:10,titleName:["首页","校园墙"],theTitleIndex:1,schoolOneTitleIndex:0,statusBarHeight:0,navBarHeight:0,tabBarHeight:0,searchInputText:"",inputBottomHeight:0,titles:["综合","话题","组队/搭子","分享/安利","兼职","表白","求助","其他"],textWidths:0,tempAddressTitle:"",tempSchoolTitle:"",theAddress:{title:"",status:0,code:""},theSchool:{id:1,title:"",status:1,addr:"",create_id:1,update_id:1},school_datas:[]}},onLoad:function(){this.getTopIconDistance(),this.tempAddressTitle=this.$store.state.store_addressNow.title,this.tempSchoolTitle=this.$store.state.store_schoolNow.title;var t=this;(0,i.default)(n.default.mark((function e(){return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("toLogon",{});case 2:case"end":return e.stop()}}),e)})))()},onShow:function(){this.$store.commit("changePreviousPage",{previousPage:0,isPage_2:!1}),this.theAddress=this.$store.state.store_addressNow,this.theSchool=this.$store.state.store_schoolNow;var e=this;""==e.theAddress.title&&t.showModal({title:"温馨提示：",content:"您当前还没有选择地区，点击“前往”将前往地区选择哦~",confirmText:"前往",confirmColor:"#f89f12",showCancel:!1,success:function(t){t.confirm&&e.toAddress()}}),e.tempAddressTitle!=e.theAddress.title&&(0,i.default)(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.theSchool={id:0,title:"",status:1,addr:"",create_id:1,update_id:1},e.$store.commit("changeStore_schoolNow",{id:0,title:"",status:1,addr:"",create_id:1,update_id:1}),e.theGetMomentsListPage=1,e.school_datas=[],t.next=6,e.getMomentsList();case 6:e.tempAddressTitle=e.$store.state.store_addressNow.title;case 7:case"end":return t.stop()}}),t)})))(),e.tempSchoolTitle!=e.theSchool.title&&(0,i.default)(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.theGetMomentsListPage=1,e.school_datas=[],t.next=4,e.getMomentsList();case 4:e.tempSchoolTitle=e.$store.state.store_schoolNow.title;case 5:case"end":return t.stop()}}),t)})))()},onPullDownRefresh:function(){var e=this;e.theGetMomentsListPage=1,this.searchInputText="",e.school_datas=[],(0,i.default)(n.default.mark((function s(){return n.default.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,e.getMomentsList();case 2:t.stopPullDownRefresh();case 3:case"end":return s.stop()}}),s)})))()},onReachBottom:function(){this.isLoading="loading",this.getMomentsList()},methods:{getTopIconDistance:function(){var e=this;t.getSystemInfo({success:function(s){e.statusBarHeight=s.statusBarHeight||0;var o=t.getMenuButtonBoundingClientRect();e.navBarHeight=o.height+2*(o.top-e.statusBarHeight),e.tabBarHeight=s.screenHeight-s.safeArea.bottom,e.$store.commit("changeNavBarHeight",{statusBarHeight:e.statusBarHeight,navBarHeight:e.navBarHeight,tabBarHeight:e.tabBarHeight})},fail:function(t){}})},inputBindFocus:function(t){this.inputBottomHeight=t.detail.height},inputBindBlur:function(){this.inputBottomHeight=0},toTitleOne:function(e){0==e?t.showToast({title:"当前功能区暂未开放哦，敬请期待~",duration:2500,icon:"none"}):this.theTitleIndex=e},choiseOneTitle:function(t){this.schoolOneTitleIndex=t},emptyInput:function(t){"searchInputText"&&(this.searchInputText="")},toAddress:function(){t.navigateTo({url:"/pages/index/address?type=index"})},toSchool:function(){t.navigateTo({url:"/pages/index/school"})},toDetail:function(e){t.navigateTo({url:"/pages/index/detail?id="+e})},topPerSonalhome:function(e){t.navigateTo({url:"/pages/follow/personalhome?id="+e})},getMomentsList:function(){var e=this;return new Promise((function(s,o){var a=e;a.isLoading="loading",""!=a.$store.state.store_addressNow.title&&t.request({url:a.$store.state.theUrl+"/wechat/moments/getMomentsList",method:"POST",header:{token:a.$store.state.theToken},data:{page:a.theGetMomentsListPage,pagesize:a.theGetMomentsListPagesize,type:"",title:a.searchInputText,school_id:a.$store.state.store_schoolNow.id,area_code:a.$store.state.store_addressNow.code},success:function(e){var o=a;if(1==o.theGetMomentsListPage&&(o.school_datas=[]),0==e.data.code)if(0!=e.data.data.length){for(var r=0;r<e.data.data.length;r++)o.school_datas.push(e.data.data[r]);o.isLoading="no-more",o.theGetMomentsListPage+=1,s()}else o.isLoading="no-more",s();else 500==e.data.code?t.showToast({title:"服务器连接失败，请反馈官方客服哦~",duration:2500,icon:"none"}):410==e.data.code?t.showModal({title:"温馨提示：",content:"当前登录身份已过期，点击“重新登录”继续吧~",confirmText:"重新登录",confirmColor:"#f89f12",showCancel:!1,success:function(t){if(t.confirm){var e=o;(0,i.default)(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("toLogon",{});case 2:e.school_datas=[],e.getMomentsList();case 4:case"end":return t.stop()}}),t)})))()}}}):t.showToast({title:e.data.msg,duration:2500,icon:"none"})},fail:function(e){t.showToast({title:"网络失败，请重试！多次无效后，反馈官方客服哦！",duration:2500,icon:"none"})}})}))},searchPost:function(){this.school_datas=[],this.theGetMomentsListPage=1,this.getMomentsList()},toThumb:function(){var e=(0,i.default)(n.default.mark((function e(s){var o,i;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=s.is_thumb,e.next=3,this.$store.dispatch("toThumb",{id:s.id,is_thumb:s.is_thumb});case 3:if(1==this.$store.state.is_thumb_true)for(i=0;i<this.school_datas.length;i++)s.id==this.school_datas[i].id&&(2==o?(this.$set(this.school_datas[i],"thumb_num",this.school_datas[i].thumb_num+1),this.$set(this.school_datas[i],"is_thumb",1),t.showToast({title:"点赞成功",duration:1e3,icon:"none"})):(this.$set(this.school_datas[i],"thumb_num",this.school_datas[i].thumb_num-1),this.$set(this.school_datas[i],"is_thumb",2),t.showToast({title:"已取消点赞",duration:1e3,icon:"none"})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),zuduiButtons:function(){var e=(0,i.default)(n.default.mark((function e(s){var o,i;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(1!=s.type){e.next=5;break}return o=s.is_entry,e.next=4,this.$store.dispatch("toEntry",{id:s.id,is_entry:s.is_entry});case 4:if(1==this.$store.state.is_entry_true)for(i=0;i<this.school_datas.length;i++)s.id==this.school_datas[i].id&&(2==o?(this.$set(this.school_datas[i],"entry_num",this.school_datas[i].entry_num+1),this.$set(this.school_datas[i],"is_entry",1),t.showToast({title:"加入成功",duration:1e3,icon:"none"})):(this.$set(this.school_datas[i],"entry_num",this.school_datas[i].entry_num-1),this.$set(this.school_datas[i],"is_entry",2),t.showToast({title:"已退出组队",duration:1e3,icon:"none"})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}};e.default=a}).call(this,s("543d")["default"])},"41c8":function(t,e,s){"use strict";(function(t,e){var o=s("4ea4");s("12b4");o(s("66fd"));var n=o(s("92a2"));t.__webpack_require_UNI_MP_PLUGIN__=s,e(n.default)}).call(this,s("bc2e")["default"],s("543d")["createPage"])},"69bd":function(t,e,s){"use strict";var o=s("873f"),n=s.n(o);n.a},"873f":function(t,e,s){},"92a2":function(t,e,s){"use strict";s.r(e);var o=s("954c"),n=s("d94f");for(var i in n)["default"].indexOf(i)<0&&function(t){s.d(e,t,(function(){return n[t]}))}(i);s("69bd");var a=s("f0c5"),r=Object(a["a"])(n["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);e["default"]=r.exports},"954c":function(t,e,s){"use strict";s.d(e,"b",(function(){return n})),s.d(e,"c",(function(){return i})),s.d(e,"a",(function(){return o}));var o={uniIcons:function(){return Promise.all([s.e("common/vendor"),s.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(s.bind(null,"d873"))},postTypeZudui:function(){return s.e("uni_modules/post-type-zudui/components/post-type-zudui/post-type-zudui").then(s.bind(null,"48c1"))},uniLoadMore:function(){return Promise.all([s.e("common/vendor"),s.e("uni_modules/uni-load-more/components/uni-load-more/uni-load-more")]).then(s.bind(null,"7aac"))},tabBar:function(){return s.e("uni_modules/tab-Bar/components/tab-Bar/tab-Bar").then(s.bind(null,"6100"))}},n=function(){var t=this,e=t.$createElement,s=(t._self._c,t.theAddress.title.length),o=s<4?null:t.theAddress.title.substring(0,3),n=""!=t.theSchool.title?t.theSchool.title.length:null,i=""==t.theSchool.title||n<5?null:t.theSchool.title.substring(0,4),a=t.titles.length;t._isMounted||(t.e0=function(e){return t.$public.disabled_tip("高级筛选")}),t.$mp.data=Object.assign({},{$root:{g0:s,g1:o,g2:n,g3:i,g4:a}})},i=[]},d94f:function(t,e,s){"use strict";s.r(e);var o=s("4042"),n=s.n(o);for(var i in o)["default"].indexOf(i)<0&&function(t){s.d(e,t,(function(){return o[t]}))}(i);e["default"]=n.a}},[["41c8","common/runtime","common/vendor"]]]);