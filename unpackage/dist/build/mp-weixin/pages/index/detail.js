(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/detail"],{"1fb2":function(t,e,n){"use strict";(function(t,e){var o=n("4ea4");n("f290");o(n("66fd"));var a=o(n("d349"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(a.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},"37a4":function(t,e,n){"use strict";(function(t){var o=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(n("2eee")),i=o(n("c973")),s={data:function(){return{isLoading:"loading",totalCount:11,theGetCommentListPage:1,theGetCommentListPagesize:10,detailData:{content:"这是一段描述的内容，也就是活动的详情内容，但是只有详情页才有这个字段。",members:[{id:"1",nick_name:"黄",avatar_url:"https://schoolwx.oss-cn-hangzhou.aliyuncs.com/school/img/20230513/168394053478518.png"}],id:1,title:"欢迎来到氧气仓库官方资讯，这里有最前沿的校园资讯分享，快来和我一起看看吧～",url:"https://schoolwx.oss-cn-hangzhou.aliyuncs.com/school/img/20230518/1684379049443118.png,https://schoolwx.oss-cn-hangzhou.aliyuncs.com/school/img/20230518/1684379049443118.png",pid:0,is_on:1,is_hot:2,school_id:3,type:"组队/搭子",label:"#打球,#吃喝玩,#看电影,#看电影,#看电影,#看电影,#看电影,#看电影,#看电影",is_anonymous:1,wages:"",settlement:"",hope_num:10,free_type:"AA",is_entry:1,area_code:"640100",task_id:0,created_at:"2021-05-18 11:05:13",released_at:"2021-03-11 16:05:13",create_id:50,sex_type:"不限",start_at:"2021-03-15",end_at:"2021-03-17",is_regard:2,is_thumb:2,thumb_num:1,comment_num:0,entry_num:3,nick_name:"氧*",avatar_url:"https://schoolwx.oss-cn-hangzhou.aliyuncs.com/school/img/20230518/1684378586065116.png",school_name:"宁波大学",area_name:"银川市"},theInputComment:"",theComments:[{id:1,moments_id:1,msg:"。",create_id:1,created_at:"",thumb_num:0,is_thumb:1,nick_name:"",avatar_url:""}]}},onLoad:function(t){var e=this;(0,i.default)(a.default.mark((function n(){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log("option",t),n.next=3,e.$store.dispatch("getMomentInfo",{id:t.id});case 3:e.detailData=e.$store.state.theDetailData,e.getCommentList();case 5:case"end":return n.stop()}}),n)})))()},onPullDownRefresh:function(){var e=this;e.theGetCommentListPage=1,e.theComments=[],e.theInputComment="",e.totalCount=11,(0,i.default)(a.default.mark((function n(){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.getCommentList();case 2:t.stopPullDownRefresh();case 3:case"end":return n.stop()}}),n)})))()},onReachBottom:function(){this.isLoading="loading",this.getCommentList()},methods:{showDateTime:function(t){return"刚刚"!=t.created_at?this.$public.showDateTime(t.created_at):"刚刚"},topPerSonalhome:function(e){2==e.is_anonymous?t.navigateTo({url:"/pages/follow/personalhome?id="+e.id}):t.showToast({title:"这个人很神秘，不想让你看到TA的主页~",duration:2500,icon:"none"})},toThumb:function(){var e=(0,i.default)(a.default.mark((function e(n){var o;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=n.is_thumb,e.next=3,this.$store.dispatch("toThumb",{id:n.id,is_thumb:n.is_thumb});case 3:1==this.$store.state.is_thumb_true&&(2==o?(this.$set(this.detailData,"thumb_num",this.detailData.thumb_num+1),this.$set(this.detailData,"is_thumb",1),t.showToast({title:"点赞成功",duration:1e3,icon:"none"})):(this.$set(this.detailData,"thumb_num",this.detailData.thumb_num-1),this.$set(this.detailData,"is_thumb",2),t.showToast({title:"已取消点赞",duration:1e3,icon:"none"})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),actionMore:function(e){var n=this,o=e.is_collection;t.showActionSheet({itemList:[2==e.is_collection?"收藏该内容":"取消收藏该内容","举报"],itemColor:"#f89f12",success:function(s){if(0==s.tapIndex){var u=n;(0,i.default)(a.default.mark((function n(){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,u.$store.dispatch("toCollection",{id:e.id});case 2:1==u.$store.state.is_collection_true&&(2==o?(u.$set(u.detailData,"is_collection",1),t.showToast({title:"收藏成功",duration:1e3,icon:"none"})):(u.$set(u.detailData,"is_collection",2),t.showToast({title:"已取消收藏",duration:1e3,icon:"none"})));case 3:case"end":return n.stop()}}),n)})))()}else t.showToast({title:"举报成功",duration:1e3,icon:"none"})},fail:function(t){}})},zuduiButtons:function(){var e=(0,i.default)(a.default.mark((function e(n){var o,i;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(1!=n.type){e.next=5;break}return o=n.is_entry,e.next=4,this.$store.dispatch("toEntry",{id:n.id,is_entry:n.is_entry});case 4:if(1==this.$store.state.is_entry_true)if(2==o)this.$set(this.detailData,"entry_num",this.detailData.entry_num+1),this.$set(this.detailData,"is_entry",1),this.detailData.members.push({id:this.$store.state.theLogonUser.id,nick_name:this.$store.state.theLogonUser.nick_name,avatar_url:this.$store.state.theLogonUser.avatar_url}),t.showToast({title:"加入成功",duration:1e3,icon:"none"});else{for(this.$set(this.detailData,"entry_num",this.detailData.entry_num-1),this.$set(this.detailData,"is_entry",2),i=0;i<this.detailData.members.length;i++)this.$store.state.theLogonUser.id==this.detailData.members[i].id&&this.detailData.members.splice(i,1);t.showToast({title:"已退出组队",duration:1e3,icon:"none"})}case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),getCommentList:function(){var e=this;return new Promise((function(n,o){var s=e;s.isLoading="loading",s.theComments.length<s.totalCount&&t.request({url:s.$store.state.theUrl+"/wechat/moments/getCommentList",method:"POST",header:{token:s.$store.state.theToken},data:{page:s.theGetCommentListPage,pagesize:s.theGetCommentListPagesize,moments_id:s.detailData.id},success:function(e){var o=s;if(1==o.theGetCommentListPage&&(o.theComments=[],o.totalCount=e.data.count),0==e.data.code){for(var u=0;u<e.data.data.length;u++)o.theComments.push(e.data.data[u]);o.theGetCommentListPage+=1,n()}else if(500==e.data.code)t.showToast({title:"服务器连接失败，请反馈官方客服哦~",duration:2500,icon:"none"});else if(410==e.data.code){var r=o;(0,i.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r.$store.dispatch("toLogon",{});case 2:r.getCommentList();case 3:case"end":return t.stop()}}),t)})))()}else t.showToast({title:e.data.msg,duration:2500,icon:"none"})},fail:function(e){console.log(333),t.showToast({title:"网络失败，请重试！多次无效后，反馈官方客服哦！",duration:2500,icon:"none"})}})}))},toComment:function(){var e=this;return new Promise((function(n,o){var s=e;[1,2].includes(s.$store.state.theLogonUser.level)?""!=s.theInputComment?t.request({url:s.$store.state.theUrl+"/wechat/moments/comment",method:"POST",header:{token:s.$store.state.theToken},data:{msg:s.theInputComment,moments_id:s.detailData.id},success:function(e){var o=s;if(0==e.data.code)o.theComments.unshift({id:0,moments_id:o.detailData.id,msg:o.theInputComment,create_id:o.$store.state.theLogonUser.id,created_at:"刚刚",thumb_num:0,is_thumb:2,nick_name:o.$store.state.theLogonUser.nick_name,avatar_url:o.$store.state.theLogonUser.avatar_url}),o.theInputComment="",n();else if(500==e.data.code)t.showToast({title:"服务器连接失败，请反馈官方客服哦~",duration:2500,icon:"none"});else if(410==e.data.code){var u=o;(0,i.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u.$store.dispatch("toLogon",{});case 2:u.toComment();case 3:case"end":return t.stop()}}),t)})))()}else t.showToast({title:e.data.msg,duration:2500,icon:"none"})},fail:function(e){t.showToast({title:"网络失败，请重试！多次无效后，反馈官方客服哦！",duration:2500,icon:"none"})}}):t.showToast({title:"评论内容不能为空哦~",duration:2500,icon:"none"}):t.navigateTo({url:"/pages/mine/register?level="+s.$store.state.theLogonUser.level})}))},commentThumb:function(e,n){var o=this,s=e;t.request({url:o.$store.state.theUrl+"/wechat/moments/commentThumb",method:"POST",header:{token:o.$store.state.theToken},data:{comment_id:e.id},success:function(e){var u=o;if(0==e.data.code)2==s.is_thumb?(u.theComments[n].is_thumb=1,u.theComments[n].thumb_num+=1):(u.theComments[n].is_thumb=2,u.theComments[n].thumb_num-=1);else if(500==e.data.code)t.showToast({title:"服务器连接失败，请反馈官方客服哦~",duration:2500,icon:"none"});else if(410==e.data.code){var r=u;(0,i.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r.$store.dispatch("toLogon",{});case 2:r.commentThumb();case 3:case"end":return t.stop()}}),t)})))()}else t.showToast({title:e.data.msg,duration:2500,icon:"none"})},fail:function(e){t.showToast({title:"网络失败，请重试！多次无效后，反馈官方客服哦！",duration:2500,icon:"none"})}})}}};e.default=s}).call(this,n("543d")["default"])},"7eb9":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}));var o={postTypeZudui:function(){return n.e("uni_modules/post-type-zudui/components/post-type-zudui/post-type-zudui").then(n.bind(null,"8625"))},uniIcons:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(n.bind(null,"beec"))},uniLoadMore:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-load-more/components/uni-load-more/uni-load-more")]).then(n.bind(null,"db88"))},uniEasyinput:function(){return n.e("uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput").then(n.bind(null,"8708"))}},a=function(){var t=this,e=t.$createElement,n=(t._self._c,t.theComments.length),o=t.__map(t.theComments,(function(e,o){var a=t.__get_orig(e),i=n>0?t.showDateTime(e):null;return{$orig:a,m0:i}}));t.$mp.data=Object.assign({},{$root:{g0:n,l0:o}})},i=[]},b863:function(t,e,n){},c22d:function(t,e,n){"use strict";n.r(e);var o=n("37a4"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=a.a},d349:function(t,e,n){"use strict";n.r(e);var o=n("7eb9"),a=n("c22d");for(var i in a)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(i);n("fab8");var s=n("f0c5"),u=Object(s["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);e["default"]=u.exports},fab8:function(t,e,n){"use strict";var o=n("b863"),a=n.n(o);a.a}},[["1fb2","common/runtime","common/vendor"]]]);