require('../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["page_product/pages/search/searchResult"],{"17de":function(e,t,r){"use strict";(function(e){var i=r("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(r("2eee")),o=i(r("c973")),n=i(r("9523"));function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h={components:{},data:function(){return{orderType:"desc",order_field:"sort",isLoading:"loading",pxList:[{label:"综合",type:"sort"},{label:"销量",type:"sale_num"},{label:"价格",type:"sale_price"}],theGetMomentsListPage:1,theGetMomentsListPagesize:6,searchText:"",searchRecord:[],contentText:{contentdown:"查看更多",contentrefresh:"加载中...",contentnomore:"到底了，可点击此处手动加载~"},list:[],contentHeight:0,shopId:"",from:""}},onLoad:function(t){var r=this,i=e.createSelectorQuery().in(this);i.select(".top-fixd").boundingClientRect((function(e){r.contentHeight=e.height})).exec(),t.shopId&&(this.shopId=t.shopId),t.from&&(this.from=t.from,e.setNavigationBarTitle({title:"选择关联商品"}),this.getList()),t.text&&(this.searchText=t.text,this.searchReasult())},onReachBottom:function(){this.isLoading="loading",this.getList()},methods:{changeType:function(e,t){this.order_field==e.type&&2!=t||(this.order_field=e.type,this.orderType=2==t&&"desc"==this.orderType?"asc":"desc",this.theGetMomentsListPage=1,this.list=[],this.isLoading="loading",this.getList())},goDetail:function(t){this.from?(e.$emit("pushProduct",t),e.navigateBack({delta:1})):e.navigateTo({url:"/page_product/pages/product/detail?id="+t.id})},changeText:function(t){t||this.from||e.navigateBack()},cancel:function(){var t=this.from?1:2;e.navigateBack({delta:t})},getSearchRecord:function(){var t="searchRecord";if(this.shopId?t="searchShopRecord":this.from&&(t="searchPushRecord"),this.searchRecord=e.getStorageSync(t)?JSON.parse(e.getStorageSync(t)):[]||!1,this.searchRecord.length>0)for(var r in this.searchRecord)r>9&&this.searchRecord.splice(r,1)},getList:function(){var e=this;this.isLoading="loading";var t={page:this.theGetMomentsListPage,pagesize:this.theGetMomentsListPagesize,title:this.searchText,order_type:this.orderType,order_field:this.order_field,is_product:1};t=this.shopId?c(c({},t),{},{shop_id:this.shopId}):c(c({},t),{},{area_code:this.$store.state.store_addressNow.code}),this.from&&delete t.area_code,this.API.home.getTaskList(t).then((function(t){if(console.log(t),1==e.theGetMomentsListPage&&(e.list=[]),0!=t.data.length){for(var r=0;r<t.data.length;r++)e.list.push(c(c({},t.data[r]),{},{img_url:t.data[r].img_url?t.data[r].img_url.split(",")[0]:""}));e.isLoading="no-more",e.theGetMomentsListPage+=1}else e.isLoading="no-more"})).catch(function(){var t=(0,o.default)(s.default.mark((function t(r){return s.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(410!=r.code){t.next=4;break}return t.next=3,e.$store.dispatch("toLogon",{});case 3:e.getList();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},searchReasult:function(){if(this.from)this.theGetMomentsListPage=1,this.list=[],this.getList();else if(this.searchText){for(var t in this.getSearchRecord(),this.searchRecord)this.searchText==this.searchRecord[t].value&&this.searchRecord.splice(t,1);this.searchRecord.unshift({value:this.searchText});var r="searchRecord";this.shopId?r="searchShopRecord":this.from&&(r="searchPushRecord"),e.setStorageSync(r,JSON.stringify(this.searchRecord)),this.theGetMomentsListPage=1,this.list=[],this.getList()}}}};t.default=h}).call(this,r("543d")["default"])},"4df8":function(e,t,r){"use strict";var i=r("ba29"),s=r.n(i);s.a},"80d8":function(e,t,r){"use strict";(function(e,t){var i=r("4ea4");r("f290"),r("5c17");i(r("66fd"));var s=i(r("a319"));e.__webpack_require_UNI_MP_PLUGIN__=r,t(s.default)}).call(this,r("bc2e")["default"],r("543d")["createPage"])},"9dfe":function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return i}));var i={uSearch:function(){return Promise.all([r.e("common/vendor"),r.e("uni_modules/uview-ui/components/u-search/u-search")]).then(r.bind(null,"4f1c"))},uniLoadMore:function(){return Promise.all([r.e("common/vendor"),r.e("uni_modules/uni-load-more/components/uni-load-more/uni-load-more")]).then(r.bind(null,"db88"))}},s=function(){var e=this.$createElement;this._self._c},o=[]},a319:function(e,t,r){"use strict";r.r(t);var i=r("9dfe"),s=r("f1dd");for(var o in s)["default"].indexOf(o)<0&&function(e){r.d(t,e,(function(){return s[e]}))}(o);r("4df8");var n=r("f0c5"),a=Object(n["a"])(s["default"],i["b"],i["c"],!1,null,"5cb23676",null,!1,i["a"],void 0);t["default"]=a.exports},ba29:function(e,t,r){},f1dd:function(e,t,r){"use strict";r.r(t);var i=r("17de"),s=r.n(i);for(var o in i)["default"].indexOf(o)<0&&function(e){r.d(t,e,(function(){return i[e]}))}(o);t["default"]=s.a}},[["80d8","common/runtime","common/vendor"]]]);