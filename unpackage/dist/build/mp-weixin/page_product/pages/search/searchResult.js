require('../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["page_product/pages/search/searchResult"],{"17de":function(e,t,r){"use strict";(function(e){var o=r("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r("2eee")),i=o(r("c973")),s=o(r("9523"));function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d={components:{},data:function(){return{orderType:"desc",order_field:"sort",isLoading:"loading",pxList:[{label:"综合",type:"sort"},{label:"销量",type:"sale_num"},{label:"价格",type:"sale_price"}],theGetMomentsListPage:1,theGetMomentsListPagesize:4,searchText:"",searchRecord:[],contentText:{contentdown:"查看更多",contentrefresh:"加载中...",contentnomore:"到底了，可点击此处手动加载~"},list:[],contentHeight:0,shopId:"",from:""}},onLoad:function(t){var r=this,o=e.createSelectorQuery().in(this);o.select(".top-fixd").boundingClientRect((function(e){r.contentHeight=e.height})).exec(),t.shopId&&(this.shopId=t.shopId),t.from&&(this.from=t.from),t.text&&(this.searchText=t.text,this.searchReasult())},onReachBottom:function(){this.isLoading="loading",this.getList()},methods:{changeType:function(e,t){this.order_field==e.type&&2!=t||(this.order_field=e.type,this.orderType=2==t&&"desc"==this.orderType?"asc":"desc",this.theGetMomentsListPage=1,this.list=[],this.isLoading="loading",this.getList())},goDetail:function(t){this.from?(e.$emit("pushProduct",t),e.navigateBack({delta:2})):e.navigateTo({url:"/page_product/pages/product/detail?id="+t.id})},changeText:function(t){t||e.navigateBack()},cancel:function(){e.navigateBack({delta:2})},getSearchRecord:function(){var t="searchRecord";if(this.shopId?t="searchShopRecord":this.from&&(t="searchPushRecord"),this.searchRecord=e.getStorageSync(t)?JSON.parse(e.getStorageSync(t)):[]||!1,this.searchRecord.length>0)for(var r in this.searchRecord)r>9&&this.searchRecord.splice(r,1)},getList:function(){var e=this;this.isLoading="loading";var t={page:this.theGetMomentsListPage,pagesize:this.theGetMomentsListPagesize,title:this.searchText,order_type:this.orderType,order_field:this.order_field,is_product:1};t=this.shopId?c(c({},t),{},{shop_id:this.shopId}):c(c({},t),{},{area_code:this.$store.state.store_addressNow.code}),this.API.home.getTaskList(t).then((function(t){if(console.log(t),1==e.theGetMomentsListPage&&(e.list=[]),0!=t.data.length){for(var r=0;r<t.data.length;r++)e.list.push(c(c({},t.data[r]),{},{img_url:t.data[r].img_url?t.data[r].img_url.split(",")[0]:""}));e.isLoading="no-more",e.theGetMomentsListPage+=1}else e.isLoading="no-more"})).catch(function(){var t=(0,i.default)(n.default.mark((function t(r){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(410!=r.code){t.next=4;break}return t.next=3,e.$store.dispatch("toLogon",{});case 3:e.getList();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},searchReasult:function(){if(this.searchText){for(var t in this.getSearchRecord(),this.searchRecord)this.searchText==this.searchRecord[t].value&&this.searchRecord.splice(t,1);this.searchRecord.unshift({value:this.searchText});var r="searchRecord";this.shopId?r="searchShopRecord":this.from&&(r="searchPushRecord"),e.setStorageSync(r,JSON.stringify(this.searchRecord)),this.getList()}}}};t.default=d}).call(this,r("543d")["default"])},"2cff":function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return o}));var o={uSearch:function(){return Promise.all([r.e("common/vendor"),r.e("uni_modules/uview-ui/components/u-search/u-search")]).then(r.bind(null,"4f1c"))},uniLoadMore:function(){return Promise.all([r.e("common/vendor"),r.e("uni_modules/uni-load-more/components/uni-load-more/uni-load-more")]).then(r.bind(null,"db88"))}},n=function(){var e=this.$createElement;this._self._c},i=[]},"52d2":function(e,t,r){"use strict";var o=r("6e85"),n=r.n(o);n.a},"6e85":function(e,t,r){},"80d8":function(e,t,r){"use strict";(function(e,t){var o=r("4ea4");r("f290");o(r("66fd"));var n=o(r("a319"));e.__webpack_require_UNI_MP_PLUGIN__=r,t(n.default)}).call(this,r("bc2e")["default"],r("543d")["createPage"])},a319:function(e,t,r){"use strict";r.r(t);var o=r("2cff"),n=r("f1dd");for(var i in n)["default"].indexOf(i)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(i);r("52d2");var s=r("f0c5"),a=Object(s["a"])(n["default"],o["b"],o["c"],!1,null,"0dfbbfa5",null,!1,o["a"],void 0);t["default"]=a.exports},f1dd:function(e,t,r){"use strict";r.r(t);var o=r("17de"),n=r.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){r.d(t,e,(function(){return o[e]}))}(i);t["default"]=n.a}},[["80d8","common/runtime","common/vendor"]]]);